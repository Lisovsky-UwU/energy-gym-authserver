import{l as h,A as c,_ as u}from"./index-9bce5a41.js";const r=h(),m=c("userData",{state:()=>({userData:null}),getters:{fullname(){var t,a,e;return this.userData?`${(t=this.userData)==null?void 0:t.secondname} ${(a=this.userData)==null?void 0:a.firstname} ${(e=this.userData)==null?void 0:e.surname}`:"No data"},role(){var t;return((t=this.userData)==null?void 0:t.role)||"No data"},group(){var t;return((t=this.userData)==null?void 0:t.group)||"No data"},studentCard(){var t;return((t=this.userData)==null?void 0:t.studentCard)||-1},image(){var t;return((t=this.userData)==null?void 0:t.image)||null}},actions:{set(t){this.userData=t},updateImage(t){this.userData={...this.userData,image:t}},invalidate(){this.userData=null},async loadNewPhoto(t,a){const e=t.target.files[0];if(!e.type.startsWith("image/")){r.showError("Загружаемый файл должен быть картинкой");return}const s=new FormData;s.append("image",e);try{const o=await u(()=>import("./api-5013437e.js"),["assets/api-5013437e.js","assets/index-9bce5a41.js","assets/index-602d2a1d.css"]);let n=a=="STUDENT"?o.useApiStudentStore():o.useApiCoachStore();const i=await fetch("/media/update-my-picture",{method:"POST",headers:{Authorization:n.token},body:s});if(i.status==200){r.showSuccess("Новое изображение успешно загружено");const d=await i.json();this.updateImage(d.imgName)}else r.showError("Возникла ошибка при загрузке изображения")}catch{r.showError("Возникла ошибка при загрузке изображения")}},async changePassword(t,a,e){const s=await u(()=>import("./api-5013437e.js"),["assets/api-5013437e.js","assets/index-9bce5a41.js","assets/index-602d2a1d.css"]);await(e=="STUDENT"?s.useApiStudentStore():s.useApiCoachStore()).doRequest("/user/edit-password","PUT",{oldPassword:t,newPassword:a}),r.showSuccess("Пароль успешно изменен")}}});export{m as u};
