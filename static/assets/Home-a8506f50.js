import{A as J,d as K,l as Q,m as b,r as y,o as W,a,c as n,b as e,y as V,B as X,z as M,u as s,e as p,F as C,h as T,f as x,g as $,q as Y,n as k,s as U,w as j,t as i,p as Z,k as ee}from"./index-13497349.js";import{_ as te}from"./default_avatar-05943288.js";import{n as se,S as N,g as oe,i as le,o as ae}from"./mdi-744fba57.js";import{U as ne}from"./Input-512782be.js";import{L as B}from"./Loading-95ec2321.js";import{L as O}from"./LoadingSmall-c082d992.js";import{u as de,M as F}from"./news-21f63dea.js";import{useApiCoachStore as ie}from"./api-c0bedf42.js";import{_ as re}from"./_plugin-vue_export-helper-c27b6911.js";import"./user-1ccd504c.js";const H=ie(),ue=J("visit",{state:()=>({visits:[]}),actions:{async loadForDate(c,r){this.visits=[],this.visits=await H.doRequest("/visit/get","POST",{date:c,time:r})},async updateVisit(c,r){await H.doRequest("/visit/edit","PUT",{id:c,mark:r})}}}),d=c=>(Z("data-v-ca4fbe02"),c=c(),ee(),c),ce={class:"sm:h-full flex flex-col lg:flex-row gap-5 sm:gap-14 min-w-64"},pe={class:"basis-1/2 bg-background rounded-md relative flex flex-col gap-4 p-4 overflow-visible sm:overflow-auto min-h-72 place-items-center"},me={class:"flex flex-row gap-4"},fe=d(()=>e("option",{value:"16:00"},"16:00",-1)),ve=d(()=>e("option",{value:"17:30"},"17:30",-1)),we=d(()=>e("option",{value:"19:00"},"19:00",-1)),xe=d(()=>e("option",{value:"20:30"},"20:30",-1)),_e=[fe,ve,we,xe],he={key:0,class:"w-full h-full place-items-center flex justify-center text-xl text-center"},ge=["onClick"],be={class:"text-lg"},ye=["name","id","onUpdate:modelValue","onChange"],ke=d(()=>e("option",{value:1},"Присутствует",-1)),Ne=d(()=>e("option",{value:2},"Уважительная",-1)),Se=d(()=>e("option",{value:0},"Отсутствует",-1)),Ve=[ke,Ne,Se],Ce={key:2,class:"w-full min-h-72 h-full place-items-center gap-3 flex flex-col justify-center text-2xl text-center"},$e={class:"basis-1/2 flex flex-col bg-background rounded-md min-h-72 relative overflow-auto"},Ue={key:0,class:"w-full h-full place-items-center flex justify-center text-xl text-center"},Ie={key:1,class:"p-4 gap-4 flex flex-col"},De={class:"new-block-forward flex flex-rol"},Le=d(()=>e("br",null,null,-1)),Me=d(()=>e("div",{class:"grow"},null,-1)),Te=["onClick"],je={key:2,class:"w-full min-h-72 h-full place-items-center gap-3 flex flex-col justify-center text-2xl text-center"},Be={key:3,class:"grow"},Oe=["disabled"],Fe={class:"flex flex-col gap-6 pt-5 px-6 pb-3 rounded-md bg-background"},He=d(()=>e("span",{class:"text-2xl"}," Вы уверены что хотите удалить новость? ",-1)),qe={class:"flex place-content-center gap-2"},Ae=["disabled"],Re=["disabled"],ze={class:"flex flex-col gap-5 pt-5 rounded-md bg-background"},Ee={class:"flex flex-row px-6 gap-6"},Pe=d(()=>e("img",{src:te,alt:"default_avatar",class:"h-44"},null,-1)),Ge={class:"flex flex-col gap-3 text-left text-xl justify-center"},Je=K({__name:"Home",setup(c){const r=de(),q=Q(),_=ue();let l=b({visits:!0,news:!0,createNew:!1,deleteNew:!1});const v=y(!1),h=y(!1);let m=b({});const I=y(-1),f=b({date:new Date().toJSON().slice(0,10),time:"16:00"}),A={0:"bg-red-600",1:"bg-green-600",2:"bg-yellow-500"},g=y("");W(()=>{S(),D()});function S(){l.visits=!0,_.loadForDate(f.date,f.time).finally(()=>{l.visits=!1})}function R(u){m=b(u),h.value=!0}async function z(u,o){await _.updateVisit(u,o)}function D(){l.news=!0,r.loadGymNews("COACH").finally(()=>{l.news=!1})}function E(){const u=g.value.trim();if(!u){q.showError("Введите текст новости");return}l.createNew=!0,r.create(u).then(()=>{g.value=""}).finally(()=>{l.createNew=!1})}function P(u){I.value=u,v.value=!0}function G(){l.deleteNew=!0,r.delete(I.value).then(()=>{v.value=!1,D()}).finally(()=>{l.deleteNew=!1})}return(u,o)=>(a(),n(C,null,[e("div",ce,[e("div",pe,[e("div",me,[V(e("input",{class:"bg-second text-white p-3 rounded-md shadow-md",type:"date",id:"start",name:"trip-start","onUpdate:modelValue":o[0]||(o[0]=t=>f.date=t),onChange:o[1]||(o[1]=t=>S())},null,544),[[X,f.date]]),V(e("select",{class:"text-white rounded-md py-2 px-4 bg-second shadow-md","onUpdate:modelValue":o[2]||(o[2]=t=>f.time=t),onChange:o[3]||(o[3]=t=>S())},_e,544),[[M,f.time]])]),s(l).visits?(a(),n("div",he,[p(B)])):s(_).visits.length>0?(a(!0),n(C,{key:1},T(s(_).visits,t=>(a(),n("div",{key:t.id,class:"w-full flex gap-2"},[e("div",{class:"entry-block grow cursor-pointer",onClick:w=>R(t)},[e("span",be,i(t.user.secondname)+" "+i(t.user.firstname)+" "+i(t.user.surname),1)],8,ge),V(e("select",{class:k(`text-white rounded-md p-1 shadow-md ${A[t.mark]}`),name:`visit-${t.id}`,id:`visit-${t.id}`,"onUpdate:modelValue":w=>t.mark=w,onChange:w=>{var L;return z(t.id,Number((L=w.target)==null?void 0:L.value))}},Ve,42,ye),[[M,t.mark]])]))),128)):(a(),n("div",Ce,[p(s(N),{class:"text-primary h-20 w-20",type:"mdi",path:s(se)},null,8,["path"]),x(" На данный день отсутствуют записи студентов ")]))]),e("div",$e,[s(l).news?(a(),n("div",Ue,[p(B)])):s(r).gymNews.length>0?(a(),n("div",Ie,[(a(!0),n(C,null,T(s(r).gymNews,t=>(a(),n("div",{key:t.id,class:"new-block-back"},[e("div",De,[e("div",null,[x(" От: "+i(t.createTime)+" ",1),Le,x(" "+i(t.body),1)]),Me,e("button",{title:"Удалить объявление",class:"hover:bg-white hover:bg-opacity-15 transition-all rounded-md px-2",onClick:w=>P(t.id)},[p(s(N),{class:"h-6 w-6",type:"mdi",path:s(oe)},null,8,["path"])],8,Te)])]))),128))])):(a(),n("div",je,[p(s(N),{class:"text-tertiary h-20 w-20",type:"mdi",path:s(le)},null,8,["path"]),x(" Объявления отсутствуют ")])),s(l).news?$("",!0):(a(),n("div",Be)),s(l).news?$("",!0):(a(),n("form",{key:4,class:"w-full bg-second flex flex-row py-3 px-3 rounded-b-md",onSubmit:o[5]||(o[5]=Y(t=>E(),["prevent"]))},[p(ne,{placeholder:"Текст объявления",modelValue:g.value,"onUpdate:modelValue":o[4]||(o[4]=t=>g.value=t),class:"w-full text-lg"},null,8,["modelValue"]),e("button",{disabled:s(l).createNew,type:"submit",class:k(["text-white p-3 ml-3 rounded-md transition-all",s(l).createNew?"":"hover:bg-white hover:bg-opacity-15"])},[s(l).createNew?(a(),U(O,{key:0})):(a(),U(s(N),{key:1,class:"h-8 w-8",type:"mdi",path:s(ae)},null,8,["path"]))],10,Oe)],32))])]),p(F,{modelValue:v.value,"onUpdate:modelValue":o[8]||(o[8]=t=>v.value=t)},{default:j(()=>[e("div",Fe,[He,e("div",qe,[e("button",{disabled:s(l).deleteNew,class:k(["text-white text-xl px-6 py-2 rounded-md transition-all bg-red-600",s(l).deleteNew?"":"hover:bg-red-400"]),onClick:o[6]||(o[6]=t=>G())},[s(l).deleteNew?(a(),U(O,{key:0})):$("",!0),x(" Удалить ")],10,Ae),e("button",{disabled:s(l).deleteNew,class:k(["text-white text-xl px-6 py-2 rounded-md transition-all bg-second",s(l).deleteNew?"":"hover:bg-slate-600"]),onClick:o[7]||(o[7]=t=>v.value=!1)}," Отмена ",10,Re)])])]),_:1},8,["modelValue"]),p(F,{modelValue:h.value,"onUpdate:modelValue":o[10]||(o[10]=t=>h.value=t)},{default:j(()=>[e("div",ze,[e("div",Ee,[Pe,e("div",Ge,[e("span",null,"Студенческий: "+i(s(m).user.studentCard),1),e("span",null,i(s(m).user.secondname)+" "+i(s(m).user.firstname)+" "+i(s(m).user.surname),1),e("span",null,"Группа: "+i(s(m).user.group),1)])]),e("button",{class:"w-full bg-second text-white rounded-b-md text-xl py-3",onClick:o[9]||(o[9]=t=>h.value=!1)},"Закрыть")])]),_:1},8,["modelValue"])],64))}});const lt=re(Je,[["__scopeId","data-v-ca4fbe02"]]);export{lt as default};
