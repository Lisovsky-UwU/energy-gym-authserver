import{d as x,l as S,r as f,m as v,a as p,s as c,w as C,b as s,e as t,n as g,g as w,f as b,q as D}from"./index-d7d45e2a.js";import{M as N}from"./MainBlockLkTemplate-acedb296.js";import{U as n}from"./Input-d296cc94.js";import{L as V}from"./LoadingSmall-d4448cd8.js";import{u as T}from"./user-f854f47d.js";import"./_plugin-vue_export-helper-c27b6911.js";const _={class:"p-4 grid grid-cols-1 lg:grid-cols-2 lg:gap-4 min-h-[500px] gap-3 lg:min-h-0"},B={class:"flex place-items-center justify-center"},I=["disabled"],j={class:"lg:col-span-2 flex place-items-center justify-center"},q=["disabled"],E=s("hr",{class:"lg:col-span-2 mt-4",noshade:"",style:{height:"2px"}},null,-1),R=s("span",{class:"lg:col-span-2 text-center text-xl"}," Смена пароля ",-1),L={class:"flex place-items-center justify-center"},M=["disabled"],K=x({__name:"ProfileSettings",setup($){const m=T(),P=S(),r=f(!1),u=f(!1),i=f(!1),a=v({...m.userData}),o=v({oldPassword:"",newPassword:"",newPasswordRepeat:""});function y(){r.value=!0,m.update(a,"STUDENT").finally(()=>{r.value=!1})}function U(){if(o.newPassword!=o.newPasswordRepeat){P.showError("Новый пароль не совпадает");return}u.value=!0,m.changePassword(o.oldPassword,o.newPassword,"STUDENT").finally(()=>{u.value=!1})}function h(){const d=document.getElementById("fileInput");d==null||d.click()}function k(d){i.value=!0,m.loadNewPhoto(d,"STUDENT").finally(()=>{i.value=!1})}return(d,e)=>(p(),c(N,{title:"Настройки профиля"},{default:C(()=>[s("div",_,[t(n,{label:"Фамилия",modelValue:a.secondname,"onUpdate:modelValue":e[0]||(e[0]=l=>a.secondname=l)},null,8,["modelValue"]),t(n,{label:"Имя",modelValue:a.firstname,"onUpdate:modelValue":e[1]||(e[1]=l=>a.firstname=l)},null,8,["modelValue"]),t(n,{label:"Отчество",modelValue:a.surname,"onUpdate:modelValue":e[2]||(e[2]=l=>a.surname=l)},null,8,["modelValue"]),t(n,{label:"Студенческий билет",modelValue:a.studentCard,"onUpdate:modelValue":e[3]||(e[3]=l=>a.studentCard=l),readonly:""},null,8,["modelValue"]),t(n,{label:"Группа",modelValue:a.group,"onUpdate:modelValue":e[4]||(e[4]=l=>a.group=l)},null,8,["modelValue"]),s("div",B,[s("input",{type:"file",id:"fileInput",hidden:"",onChange:k,accept:".jpg,.png,.bmp"},null,32),s("button",{disabled:i.value,class:g([i.value?"btn-custom-load":"btn-custom","btn-custom"]),onClick:h},[i.value?(p(),c(V,{key:0})):w("",!0),b(" Выбрать фото ")],10,I)]),s("div",j,[s("button",{disabled:r.value,class:g(r.value?"btn-custom-load":"btn-custom"),onClick:e[5]||(e[5]=l=>y())},[r.value?(p(),c(V,{key:0})):w("",!0),b(" Сохранить изменения ")],10,q)]),E,R,s("form",{class:"lg:col-span-2 grid grid-cols-1 lg:grid-cols-2 lg:gap-4 gap-3",onSubmit:e[9]||(e[9]=D(l=>U(),["prevent"]))},[t(n,{type:"password",placeholder:"*******",required:"",minlength:"8",label:"Новый пароль",modelValue:o.newPassword,"onUpdate:modelValue":e[6]||(e[6]=l=>o.newPassword=l)},null,8,["modelValue"]),t(n,{type:"password",placeholder:"*******",required:"",minlength:"8",label:"Повторите новый пароль",modelValue:o.newPasswordRepeat,"onUpdate:modelValue":e[7]||(e[7]=l=>o.newPasswordRepeat=l)},null,8,["modelValue"]),t(n,{type:"password",placeholder:"*******",required:"",minlength:"8",label:"Прежний пароль",modelValue:o.oldPassword,"onUpdate:modelValue":e[8]||(e[8]=l=>o.oldPassword=l)},null,8,["modelValue"]),s("div",L,[s("button",{disabled:u.value,class:g(u.value?"btn-custom-load":"btn-custom"),type:"submit"},[u.value?(p(),c(V,{key:0})):w("",!0),b(" Сменить пароль ")],10,M)])],32)])]),_:1}))}});export{K as default};
